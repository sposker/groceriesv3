#: import Window access_app

# Various layouts for recycleviews and root widget for app


<AccessBaseRow>
    default_size: None, dp(72)
    default_size_hint: 1, None
    font_size: 20
    spacing: dp(8)
    padding: dp(8)
    orientation: 'horizontal'
    size_hint: 1, None
    height: self.minimum_height


<GroupDetailRow>
    default_size: None, dp(128)
    size_hint: 1, 1
    pos_hint: {'center_x': .5, 'center_y': .5}

#    canvas.before:
#        Color:
#            rgba: .6, .1, .6, .5
#        RoundedRectangle:
#            size: self.size
#            pos: self.pos
#            radius: [16, 16, 16, 16]

    MDIconButton:
        size_hint_max_x: dp(48)
        pos_hint: {'center_x': .5, 'center_y': .5}
        icon: 'chevron-up'
        user_font_size: 32
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            root.swap(-1)

    MDIconButton:
        size_hint_max_x: dp(48)
        pos_hint: {'center_x': .5, 'center_y': .5}
        icon: 'chevron-down'
        user_font_size: 32
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            root.swap(1)

    MDLabel:
        size_hint: .12, 1
        pos_hint: {'center_x': .5, 'center_y': .5}
        text: root.group_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color


    TextInput:
        background_color: 1, 1, 1, .5
        background_normal: '.8, .8, .8, .5'
        pos_hint: {'center_x': .5, 'center_y': .5}
        size_hint: 1, 1
        valign: 'center'
        text: root.group_name
        font_size: 22
        text_color: app.text_color


<ItemDetailRow>

    spacing: dp(8)
    padding: dp(8)

    MDLabel:
        halign: 'center'
        widget_name: 'item_uid'
        size_hint: None, 1
        text: root.item_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        width: dp(88)

    TextInput:
        widget_name: 'item_name'
        background_color: 1, 1, 1, .5
        background_normal: '.8, .8, .8, .5'
        text: root.item_name
        font_size: 18
        text_color: app.text_color
        size_hint: .4, 1
        write_tab: False

    MDLabel:
        halign: 'center'
        widget_name: 'group_uid'
        size_hint: None, 1
        text: root.item_group_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        width: dp(88)

    AccessSpinner:
        widget_name: 'group_name'
        text: root.item_group_name
        size_hint: .3, 1
        values: [grp.name for grp in self.db.groups.values()]

    AccessInputShort:
        widget_name: 'defaults0'
        text: root.item_default_0

    AccessInputShort:
        widget_name: 'defaults1'
        text: root.item_default_1

    AccessInputShort:
        widget_name: 'defaults2'
        text: root.item_default_2

    TextInput:
        widget_name: 'item_note'
        background_color: 1, 1, 1, .5
        background_normal: '.8, .8, .8, .5'
        font_size: 18
        theme_text_color: 'Custom'
        text_color: app.text_color
        text: root.item_note
        size_hint: .3, 1
        write_tab: False
        multiline: False

    MDIconButton:
        size_hint_max_x: dp(48)
        icon: 'content-save-outline'
        user_font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            root.update_value()

    MDIconButton:
        size_hint_max_x: dp(48)
        icon: 'restart'
        user_font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            root.reset_values()

    MDIconButton:
        size_hint_max_x: dp(48)
        icon: 'delete-alert'
        user_font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            root.reset_values()


<LocationMapRow>

    canvas.before:
        Color:
            rgba: .1, .6, .1, .5
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [0, 0, 16, 16]

    size_hint: .5, 1
    pos_hint: {'center_x': .5, 'center_y': .5}
    padding: [dp(32), 0]

    MDLabel:
        size_hint: .2, 1
        text: root.item_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color

    MDLabel:
        size_hint: .2, 1
        text: root.item_name
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color

    MDLabel:
        size_hint: .2, 1
        text: root.location_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color

    AccessSpinner:
        widget_name: 'location_name'
        text: root.location_name
        size_hint: .4, 1
        values: root.location_names


<LocationDetailRow>
    default_size: None, dp(128)
    size_hint: 1, 1
    pos_hint: {'center_x': .5, 'center_y': .5}

    MDIconButton:
        size_hint_max_x: dp(48)
        icon: 'chevron-up'
        user_font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            print(self.icon)

    MDIconButton:
        size_hint_max_x: dp(48)
        icon: 'chevron-down'
        user_font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color
        on_release:
            print(self.icon)

    MDLabel:
        size_hint: .12, 1
        text: root.location_uid
        font_size: 20
        theme_text_color: 'Custom'
        text_color: app.text_color


    TextInput:
        background_color: 1, 1, 1, .5
        background_normal: '.8, .8, .8, .5'
        text: root.location_name
        font_size: 22
        text_color: app.text_color


<ViewSortButton>
    sort_dir: 'ascending'
    halign: 'center'
#    size_hint: 1, 1
    font_size: 20
    theme_text_color: 'Custom'
    text_color: app.text_color
    size_hint_min_x: None
    on_release:
        self.sort()

<AccessTabbedPanel>
    default_tab: default_tab_id
    default_tab_cls: 'AccessSpinnerButton'
    pos_hint: {'center_x': .5, 'center_y': .5}
    size_hint: 1, 1
    tab_width: self.width/4

    TabbedPanelItem:
        text: 'Display Group Names & Order'
        ModGroupContent:
            id: mod_groups
#            orientation: 'vertical'

    TabbedPanelItem:
        text: 'Item Details'
        id: default_tab_id

        ItemDetailsContent:
            id: item_details
            orientation: 'vertical'
#            spacing: dp(16)
#            padding: dp(8)

            BoxLayout:
                default_size: self.width - dp(12), dp(72)
                default_size_hint: None, None
                font_size: 20
                spacing: dp(8)
                padding: dp(8)
                orientation: 'horizontal'
                size_hint: None, None
                height: self.minimum_height
                width: self.parent.width

                ViewSortButton:
                    sort_key: 'item_uid'
                    container: item_details
                    text: 'I-ID'
                    size_hint_max_x: dp(48)

                ViewSortButton:
                    sort_key: 'item_name'
                    container: item_details
                    size_hint: .4, 1
                    text: "ITEM NAME"

                ViewSortButton:
                    sort_key: 'item_group_uid'
                    container: item_details
                    text: "G-ID"
                    size_hint_max_x: dp(42)

                ViewSortButton:
                    sort_key: 'item_group_name'
                    container: item_details
                    size_hint: .3, 1
                    text: "GROUP NAME"

                MDLabel:
                    halign: 'center'
                    text: "1ST"
                    font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color
                    size_hint_max_x: dp(48)

                MDLabel:
                    halign: 'center'
                    text: "2ND"
                    font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color
                    size_hint_max_x: dp(48)

                MDLabel:
                    halign: 'center'
                    text: "3RD"
                    font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color
                    size_hint_max_x: dp(48)

                ViewSortButton:
                    sort_key: 'item_note'
                    container: item_details
                    size_hint: .3, 1
                    text: "ITEM NOTE"

                MDLabel:
                    halign: 'center'
                    size_hint_max_x: dp(48)
                    text: 'SAVE'
                    user_font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color

                MDLabel:
                    halign: 'center'
                    size_hint_max_x: dp(48)
                    text: 'RESET'
                    user_font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color

                MDLabel:
                    halign: 'center'
                    size_hint_max_x: dp(48)
                    text: 'DEL'
                    user_font_size: 20
                    theme_text_color: 'Custom'
                    text_color: app.text_color

#                Widget:
#                    size_hint: None, 1
#                    width: 0

    TabbedPanelItem:
        text: 'Item-Location Mapping'
        ItemLocationContent:
            id: locs_map
            orientation: 'vertical'
            TabbedPanel:
                pos_hint: {'center_x': .5, 'center_y': .5}
                size_hint: 1, 1

    TabbedPanelItem:
        text: 'Location Names & Order'
        ModLocationsContent:
            id: mod_locs
            orientation: 'vertical'
            TabbedPanel:
                pos_hint: {'center_x': .5, 'center_y': .5}
                size_hint: 1, 1


<AccessRoot>

    orientation: 'vertical'
#    spacing: dp(12)

    BoxLayout:
        canvas.before:
            Color:
                rgba: app.theme_cls.primary_color
            Rectangle:
                size: self.size
                pos: self.pos

        icon_color: app.text_color
        spacing: dp(40)
        padding: dp(4)
        size_hint: 1, .05
        spacing: dp(8)

        AccessMidButton:
            text: 'New Entry'
            on_release:
                self.add_new_entry(access_tabbed_panel.current_tab)

        AccessMidButton:
            text: 'Update All'
            on_release:
                self.update_from_view(access_tabbed_panel.current_tab)

        AccessMidButton:
            text: 'Save to Disk'
            on_release:
                self.dump_data(access_tabbed_panel.current_tab)

        AccessMidButton:
            text: 'Exit without saving'
            on_release:
                self.stop_app()

    AccessTabbedPanel:
        id: access_tabbed_panel


<AccessMainScreen>
    name: "Amain"
    AccessRoot:


<AccessLoadScreen>
    name: "Aloading"

    Image:
        source: 'src\\dbaccess96.png'
        pos_hint: {"center_x": 0.5, "center_y":0.5}
        size_hint: 0.25, 0.25
    MDLabel:
        color: app.text_color
        halign: 'center'
        pos_hint:{"center_x": 0.5, "top":0.425}
        size_hint:1, .1
        text: "Loading..."
        font_size: app.text_base_size * 4/5

<AccessManager>
    id: manager
    current: "Aloading"

    AccessLoadScreen:
        name: "Aloading"